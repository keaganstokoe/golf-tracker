<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GOLF TRACKER</title>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700;800&family=Inter:wght@900&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#000;--accent:#CCFF00;--white:#fff;--dim:#555;--border:#fff}
::selection{background:var(--accent);color:#000}
body{font-family:'JetBrains Mono',monospace;background:var(--bg);color:var(--white);min-height:100vh;padding-bottom:72px;-webkit-font-smoothing:antialiased}

.header{padding:20px 20px 16px;border-bottom:3px solid var(--white);position:sticky;top:0;z-index:100;background:#000;display:flex;justify-content:space-between;align-items:baseline}
.header h1{font-family:'Inter',sans-serif;font-size:1.1rem;font-weight:900;letter-spacing:6px;text-transform:uppercase;color:var(--white)}
.header h1 .accent{color:var(--accent)}
.header .tag{font-size:.55rem;letter-spacing:3px;color:var(--dim);text-transform:uppercase}

.tabs{display:flex;position:fixed;bottom:0;left:0;right:0;background:#000;border-top:3px solid var(--white);z-index:100}
.tab{flex:1;padding:14px 4px 12px;text-align:center;font-size:.6rem;letter-spacing:2px;text-transform:uppercase;color:var(--dim);cursor:pointer;border:none;background:none;font-family:'JetBrains Mono',monospace;transition:none}
.tab.active{color:#000;background:var(--accent);font-weight:700}
.tab-icon{font-size:1.1rem;display:block;margin-bottom:3px}

.page{display:none;padding:0 16px 16px;max-width:640px;margin:0 auto}
.page.active{display:block;animation:hardIn .15s ease-out}
@keyframes hardIn{0%{opacity:0;transform:translateY(8px)}100%{opacity:1;transform:translateY(0)}}

h2{font-family:'Inter',sans-serif;font-size:2.4rem;font-weight:900;text-transform:uppercase;letter-spacing:4px;margin:24px 0 20px;color:var(--white);line-height:1}
h2 .sub{display:block;font-family:'JetBrains Mono',monospace;font-size:.6rem;letter-spacing:4px;color:var(--dim);margin-top:6px;font-weight:400}

.card{border:2px solid var(--white);padding:20px;margin-bottom:16px}
.card h3{font-size:.7rem;letter-spacing:4px;text-transform:uppercase;color:var(--accent);margin-bottom:16px;font-weight:700}

.toggle-row{display:flex;gap:0;margin-bottom:20px;border:2px solid var(--white)}
.toggle-btn{flex:1;padding:12px;border:none;background:none;color:var(--dim);cursor:pointer;text-align:center;font-size:.7rem;letter-spacing:3px;text-transform:uppercase;font-family:'JetBrains Mono',monospace;font-weight:700;transition:none}
.toggle-btn.active{background:var(--white);color:#000}
.toggle-btn+.toggle-btn{border-left:2px solid var(--white)}

.stat-grid{display:grid;grid-template-columns:1fr 1fr;gap:0;margin-bottom:24px;border:2px solid var(--white)}
.stat-box{padding:16px;text-align:left;border-right:2px solid var(--white)}
.stat-box:last-child{border-right:none}
.stat-box .val{font-family:'Inter',sans-serif;font-size:2.8rem;font-weight:900;color:var(--accent);line-height:1}
.stat-box .lbl{font-size:.55rem;letter-spacing:3px;text-transform:uppercase;color:var(--dim);margin-top:4px}

.lb-row{display:grid;grid-template-columns:64px 1fr auto;align-items:center;padding:0;border-bottom:2px solid #222;transition:none;position:relative}
.lb-row:last-child{border-bottom:none}
.lb-row.leader{border:3px solid var(--accent);margin-bottom:16px;background:rgba(204,255,0,.04)}
.lb-row.leader .lb-rank{color:#000;background:var(--accent)}
.lb-rank{font-family:'Inter',sans-serif;font-size:2rem;font-weight:900;text-align:center;padding:16px 0;color:var(--dim);border-right:2px solid #222}
.lb-row.leader .lb-rank{border-right:3px solid var(--accent);font-size:2.4rem}
.lb-name{padding:12px 16px;font-weight:700;font-size:.85rem;letter-spacing:1px;text-transform:uppercase}
.lb-name .streak{display:block;font-size:.6rem;color:var(--accent);letter-spacing:2px;font-weight:400;margin-top:2px}
.lb-name .banter{display:block;font-size:.55rem;color:#888;letter-spacing:1px;font-weight:400;margin-top:4px;font-style:italic;text-transform:none}
.lb-stats{text-align:right;padding:12px 16px;font-size:.75rem}
.lb-stats span{display:block}
.lb-stats .wins{font-family:'Inter',sans-serif;font-size:1.6rem;font-weight:900;color:var(--accent);line-height:1}
.lb-stats .avg{color:var(--dim);font-size:.65rem;letter-spacing:1px;margin-top:2px}

.team-wins-row{display:flex;justify-content:space-between;align-items:center;padding:14px 16px;border-bottom:2px solid #222;font-size:.8rem;letter-spacing:1px;text-transform:uppercase}
.team-wins-row:last-child{border-bottom:none}
.team-wins-row span:last-child{font-family:'Inter',sans-serif;font-weight:900;color:var(--accent);font-size:1.2rem}

label{display:block;font-size:.6rem;letter-spacing:3px;text-transform:uppercase;color:var(--dim);margin-bottom:6px;margin-top:16px}
label:first-child{margin-top:0}
input,select{width:100%;padding:12px;background:#000;border:2px solid #333;color:var(--white);font-size:1rem;font-family:'JetBrains Mono',monospace;letter-spacing:1px}
input:focus,select:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 1px var(--accent)}
input::placeholder{color:#333}

.btn{display:block;width:100%;padding:16px;border:none;font-size:.75rem;font-weight:800;cursor:pointer;margin-top:20px;font-family:'JetBrains Mono',monospace;letter-spacing:4px;text-transform:uppercase;transition:none}
.btn-primary{background:var(--accent);color:#000}
.btn-primary:active{background:#fff}
.btn-danger{background:#000;color:#ff2d2d;border:2px solid #ff2d2d;font-size:.65rem;padding:8px;letter-spacing:3px}
.btn-danger:active{background:#ff2d2d;color:#000}
.btn-secondary{background:#000;color:var(--white);border:2px solid var(--white);font-size:.65rem;padding:12px;letter-spacing:3px}
.btn-secondary:active{background:var(--white);color:#000}

.score-input{display:flex;gap:0;align-items:stretch;border-bottom:1px solid #222;position:relative}
.score-input input[type=checkbox]{width:20px;height:20px;accent-color:var(--accent);margin:0;align-self:center;margin-left:8px}
.score-input label{margin:0;flex:1;font-size:.75rem;color:var(--white);padding:14px 12px;letter-spacing:2px;text-transform:uppercase;cursor:pointer;font-weight:700}
.score-input input[type=number]{width:80px;flex:none;text-align:center;border:none;border-left:2px solid #222;font-size:1.2rem;font-weight:800;padding:14px 8px}
.score-input select{width:80px;flex:none;border:none;border-left:2px solid #222;font-size:.7rem;letter-spacing:1px;padding:14px 8px}

.history-round{border-left:4px solid var(--accent);padding:16px;margin-bottom:2px;background:rgba(255,255,255,.02);position:relative}
.history-round .date{font-size:.65rem;letter-spacing:3px;text-transform:uppercase;color:var(--accent);font-weight:700}
.history-round .course{font-size:.6rem;letter-spacing:2px;text-transform:uppercase;color:var(--dim);margin-top:2px}
.history-round .scores{margin-top:10px;font-size:.75rem;color:var(--dim)}
.history-round .scores div{padding:3px 0;letter-spacing:1px}
.history-round .winner{color:var(--white);font-weight:700}
.month-filter{display:flex;align-items:center;justify-content:center;gap:16px;margin-bottom:20px;padding:12px 0}
.month-filter button{background:#000;border:2px solid var(--white);color:var(--white);padding:8px 16px;cursor:pointer;font-family:'JetBrains Mono',monospace;font-size:.8rem;font-weight:700}
.month-filter button:active{background:var(--white);color:#000}
.month-filter span{font-size:.7rem;letter-spacing:4px;text-transform:uppercase;color:var(--dim);min-width:140px;text-align:center}

.setup-player{display:flex;gap:0;align-items:stretch;border:2px solid #222;margin-bottom:-2px}
.setup-player span{width:40px;text-align:center;font-family:'Inter',sans-serif;font-weight:900;font-size:1.2rem;color:var(--accent);display:flex;align-items:center;justify-content:center;border-right:2px solid #222}
.setup-player input{flex:1;border:none}

.empty{text-align:center;color:var(--dim);padding:60px 20px;font-size:.7rem;letter-spacing:3px;text-transform:uppercase}
.team-label{font-size:.55rem;padding:2px 8px;letter-spacing:2px;text-transform:uppercase;font-weight:700;border:1px solid}
.team-a{border-color:var(--accent);color:var(--accent)}
.team-b{border-color:#00a8ff;color:#00a8ff}
.hidden{display:none}
.toast{position:fixed;top:0;left:0;right:0;background:var(--accent);color:#000;padding:16px 24px;font-weight:800;z-index:999;font-size:.7rem;letter-spacing:4px;text-transform:uppercase;text-align:center;animation:toastSlam .12s ease-out,toastOut .12s ease-in 1.8s forwards}
@keyframes toastSlam{0%{transform:translateY(-100%)}100%{transform:translateY(0)}}
@keyframes toastOut{0%{transform:translateY(0)}100%{transform:translateY(-100%)}}

.cb{display:flex;align-items:center;gap:6px;padding:4px 0}
.cb input[type=checkbox]{width:18px;height:18px;accent-color:var(--accent)}
.player-check-row{display:flex;align-items:center;gap:8px;padding:6px 0}
.player-check-row label{margin:0;flex:1}

::-webkit-scrollbar{width:4px}
::-webkit-scrollbar-track{background:#000}
::-webkit-scrollbar-thumb{background:var(--accent)}
</style>
</head>
<body>

<div class="header">
  <h1><span class="accent">GOLF</span> TRACKER</h1>
  <div class="tag">Built by Cove ðŸŒŠ</div>
</div>

<!-- Setup Screen -->
<div class="page" id="setupPage">
  <h2>SETUP<span class="sub">Initialize your group</span></h2>
  <div class="card">
    <h3>Player Registry</h3>
    <div id="setupNames"></div>
    <button class="btn btn-primary" onclick="saveSetup()">INITIALIZE</button>
  </div>
</div>

<!-- Leaderboard -->
<div class="page" id="leaderboardPage">
  <h2>BOARD<span class="sub">Current Standings</span></h2>
  <div class="toggle-row">
    <div class="toggle-btn active" onclick="showLB('individual')">Individual</div>
    <div class="toggle-btn" onclick="showLB('team')">Teams</div>
  </div>
  <div id="lbStats" class="stat-grid"></div>
  <div id="lbContent"></div>
</div>

<!-- Add Round -->
<div class="page" id="addRoundPage">
  <h2>LOG<span class="sub">Record New Round</span></h2>
  <div class="card">
    <h3>Round Data Input</h3>
    <label>Date</label>
    <input type="date" id="roundDate">
    <label>Course</label>
    <input type="text" id="roundCourse" placeholder="COURSE NAME">

    <label style="margin-top:20px">Type</label>
    <div class="toggle-row">
      <div class="toggle-btn active" id="typeIndividual" onclick="setRoundType('individual')">Individual</div>
      <div class="toggle-btn" id="typeTeam" onclick="setRoundType('team')">Team</div>
    </div>

    <div id="teamFormatRow" class="hidden">
      <label>Format</label>
      <div class="toggle-row">
        <div class="toggle-btn active" id="fmt2v2" onclick="setTeamFormat('2v2')">2v2</div>
        <div class="toggle-btn" id="fmt4v4" onclick="setTeamFormat('4v4')">4v4</div>
      </div>
    </div>

    <label>Scores</label>
    <div id="playerScores" style="border:2px solid #222;border-bottom:none"></div>
    <button class="btn btn-primary" onclick="saveRound()">SUBMIT ROUND</button>
  </div>
</div>

<!-- History -->
<div class="page" id="historyPage">
  <h2>ARCHIVE<span class="sub">Round History</span></h2>
  <div class="month-filter">
    <button onclick="changeMonth(-1)">&larr;</button>
    <span id="monthLabel"></span>
    <button onclick="changeMonth(1)">&rarr;</button>
  </div>
  <div id="historyContent"></div>
</div>

<!-- Settings -->
<div class="page" id="settingsPage">
  <h2>CONFIG<span class="sub">System Settings</span></h2>
  <div class="card">
    <h3>Player Names</h3>
    <div id="settingsNames"></div>
    <button class="btn btn-primary" onclick="updateNames()">UPDATE</button>
  </div>
  <div class="card">
    <h3>Data Management</h3>
    <button class="btn btn-secondary" onclick="exportData()" style="margin-top:8px">EXPORT JSON</button>
    <button class="btn btn-secondary" onclick="document.getElementById('importFile').click()" style="margin-top:8px">IMPORT DATA</button>
    <input type="file" id="importFile" accept=".json" style="display:none" onchange="importData(event)">
    <button class="btn btn-danger" onclick="clearData()" style="margin-top:16px">PURGE ALL DATA</button>
  </div>
</div>

<!-- Bottom Tabs -->
<nav class="tabs">
  <div class="tab active" onclick="showPage('leaderboard')"><span class="tab-icon">â—†</span>Board</div>
  <div class="tab" onclick="showPage('addRound')"><span class="tab-icon">+</span>Log</div>
  <div class="tab" onclick="showPage('history')"><span class="tab-icon">â–¤</span>Archive</div>
  <div class="tab" onclick="showPage('settings')"><span class="tab-icon">âš™</span>Config</div>
</nav>

<script>
const DEFAULT_PLAYERS = ['Keagan','James','Ben','Jacques','Shaun','Zach','Matt','Spencer'];
const FIRST_ROUND = {date:'2026-02-18',course:'METROPOLITAN GOLF CLUB',type:'individual',scores:{Keagan:39,James:39,Ben:39,Jacques:41}};
const BANTER_LEADER = ['Built different.','Carrying the group.','The rest of you are fighting for second.','Cold. Calculated. Clinical.','Pack it up boys.','Not even close.','Undisputed.'];
const BANTER_LAST = ['Somebody call a marshal.','At least the beer was cold.','Paying for lessons yet?','There\'s always mini golf.','The course won today.','Bless your heart.','Your handicap has a handicap.','Participation trophy incoming.','Down bad.','The trees saw more of your ball than the fairway did.'];
const BANTER_MID = ['Mid.','Room for improvement (lots of room).','Not last, not first. Switzerland.','The definition of "fine."','Your mum would be proud. Your coach wouldn\'t.','Solidly mediocre.'];
const BANTER_TIED = ['Dead heat. Settle it on the 19th hole.','Shared glory. Shared shame.','Couldn\'t separate you with a rangefinder.','Tied â€” like your shoelaces should\'ve been.'];
const BANTER_NO_SHOW = ['DNS. The coward\'s strategy.','Didn\'t fancy the embarrassment today?','Missing in action.','Probably for the best.','Smart â€” can\'t lose if you don\'t play.'];
function getBanter(pos,total,tied){if(tied)return BANTER_TIED[Math.floor(Math.random()*BANTER_TIED.length)];if(pos===0)return BANTER_LEADER[Math.floor(Math.random()*BANTER_LEADER.length)];if(pos===total-1)return BANTER_LAST[Math.floor(Math.random()*BANTER_LAST.length)];return BANTER_MID[Math.floor(Math.random()*BANTER_MID.length)];}
let state = JSON.parse(localStorage.getItem('golfTracker') || 'null') || {players:DEFAULT_PLAYERS, rounds:[FIRST_ROUND]};
let currentLB = 'individual';
let roundType = 'individual';
let teamFormat = '2v2';
let historyMonth = new Date().toISOString().slice(0,7);

function save(){localStorage.setItem('golfTracker', JSON.stringify(state))}
function toast(msg){const d=document.createElement('div');d.className='toast';d.textContent=msg;document.body.appendChild(d);setTimeout(()=>d.remove(),2100)}

function showPage(name){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  document.getElementById(name+'Page').classList.add('active');
  document.querySelectorAll('.tab')[['leaderboard','addRound','history','settings'].indexOf(name)].classList.add('active');
  if(name==='leaderboard')renderLB();
  if(name==='addRound')renderAddRound();
  if(name==='history')renderHistory();
  if(name==='settings')renderSettings();
}

function initSetup(){
  const c=document.getElementById('setupNames');
  c.innerHTML='';
  for(let i=0;i<8;i++){
    c.innerHTML+=`<div class="setup-player"><span>${String(i+1).padStart(2,'0')}</span><input type="text" id="sp${i}" placeholder="PLAYER ${i+1}"></div>`;
  }
}

function saveSetup(){
  const names=[];
  for(let i=0;i<8;i++){const v=document.getElementById('sp'+i).value.trim();if(v)names.push(v);}
  if(names.length<2){toast('MINIMUM 2 PLAYERS REQUIRED');return}
  state.players=names;save();
  document.getElementById('setupPage').classList.remove('active');
  showPage('leaderboard');
}

function showLB(type){
  currentLB=type;
  document.querySelectorAll('#leaderboardPage .toggle-btn').forEach((b,i)=>{b.classList.toggle('active',i===(type==='individual'?0:1))});
  renderLB();
}

function getPlayerStats(){
  const stats={};
  state.players.forEach(p=>stats[p]={wins:0,rounds:0,totalScore:0,best:Infinity,worst:0,scores:[],streak:0,lastResults:[]});
  const sorted=[...state.rounds].sort((a,b)=>a.date.localeCompare(b.date));
  sorted.forEach(r=>{
    if(r.type==='team')return;
    let best=Infinity, winners=[];
    Object.entries(r.scores).forEach(([p,s])=>{
      if(!stats[p])stats[p]={wins:0,rounds:0,totalScore:0,best:Infinity,worst:0,scores:[],streak:0,lastResults:[]};
      const sc=Number(s);
      stats[p].rounds++;stats[p].totalScore+=sc;stats[p].scores.push(sc);
      if(sc<stats[p].best)stats[p].best=sc;
      if(sc>stats[p].worst)stats[p].worst=sc;
      if(sc<best){best=sc;winners=[p]}
      else if(sc===best)winners.push(p);
    });
    Object.keys(r.scores).forEach(p=>{stats[p].lastResults.push(winners.includes(p))});
    winners.forEach(p=>stats[p].wins++);
  });
  Object.values(stats).forEach(s=>{
    let streak=0;
    for(let i=s.lastResults.length-1;i>=0;i--){if(s.lastResults[i])streak++;else break}
    s.streak=streak;
  });
  return stats;
}

function getTeamStats(){
  const teams={};
  state.rounds.filter(r=>r.type==='team').forEach(r=>{
    const teamScores={};
    Object.entries(r.scores).forEach(([p,s])=>{
      const t=r.teams[p]||'A';
      if(!teamScores[t])teamScores[t]={total:0,players:[]};
      teamScores[t].total+=Number(s);teamScores[t].players.push(p);
    });
    const entries=Object.entries(teamScores);
    if(entries.length<2)return;
    entries.sort((a,b)=>a[1].total-b[1].total);
    const winTeam=entries[0];
    const key=winTeam[1].players.sort().join(' & ');
    if(!teams[key])teams[key]={wins:0,rounds:0};
    teams[key].wins++;
    entries.forEach(e=>{const k=e[1].players.sort().join(' & ');if(!teams[k])teams[k]={wins:0,rounds:0};teams[k].rounds++});
  });
  return teams;
}

function renderLB(){
  const statsEl=document.getElementById('lbStats');
  const contentEl=document.getElementById('lbContent');
  if(currentLB==='individual'){
    const stats=getPlayerStats();
    const arr=Object.entries(stats).filter(([,s])=>s.rounds>0).sort((a,b)=>b[1].wins-a[1].wins||((a[1].totalScore/a[1].rounds)-(b[1].totalScore/b[1].rounds)));
    const totalRounds=state.rounds.filter(r=>r.type!=='team').length;
    statsEl.innerHTML=`
      <div class="stat-box"><div class="val">${totalRounds}</div><div class="lbl">Rounds</div></div>
      <div class="stat-box"><div class="val">${state.players.length}</div><div class="lbl">Players</div></div>`;
    if(!arr.length){contentEl.innerHTML='<div class="empty">No data recorded â€” Log your first round</div>';return}
    contentEl.innerHTML=arr.map(([name,s],i)=>{
      const avg=s.rounds?(s.totalScore/s.rounds).toFixed(1):'â€”';
      const rank=String(i+1).padStart(2,'0');
      const streakTxt=s.streak>=2?`<span class="streak">â–² ${s.streak} STREAK</span>`:'';
      const isLeader=i===0;
      const tied=i>0&&arr[i-1][1].wins===s.wins;
      const banter=getBanter(i,arr.length,tied);
      return `<div class="lb-row${isLeader?' leader':''}"><div class="lb-rank">${rank}</div><div class="lb-name">${name.toUpperCase()} ${streakTxt}<div class="banter">${banter}</div></div><div class="lb-stats"><span class="wins">${s.wins}</span><span class="avg">AVG ${avg} Â· BEST ${s.best===Infinity?'â€”':s.best}</span></div></div>`;
    }).join('');
  } else {
    const teams=getTeamStats();
    const arr=Object.entries(teams).sort((a,b)=>b[1].wins-a[1].wins);
    const totalTeamRounds=state.rounds.filter(r=>r.type==='team').length;
    statsEl.innerHTML=`<div class="stat-box"><div class="val">${totalTeamRounds}</div><div class="lbl">Team Rounds</div></div><div class="stat-box"><div class="val">${arr.length}</div><div class="lbl">Combinations</div></div>`;
    if(!arr.length){contentEl.innerHTML='<div class="empty">No team data â€” Log a team round</div>';return}
    contentEl.innerHTML='<div style="border:2px solid #222">'+arr.map(([name,s],i)=>{
      return `<div class="team-wins-row"><span>${String(i+1).padStart(2,'0')} ${name.toUpperCase()}</span><span>${s.wins}W/${s.rounds}R</span></div>`;
    }).join('')+'</div>';
  }
}

function setRoundType(t){
  roundType=t;
  document.getElementById('typeIndividual').classList.toggle('active',t==='individual');
  document.getElementById('typeTeam').classList.toggle('active',t==='team');
  document.getElementById('teamFormatRow').classList.toggle('hidden',t==='individual');
  renderAddRound();
}
function setTeamFormat(f){
  teamFormat=f;
  document.getElementById('fmt2v2').classList.toggle('active',f==='2v2');
  document.getElementById('fmt4v4').classList.toggle('active',f==='4v4');
}

function renderAddRound(){
  if(!document.getElementById('roundDate').value){document.getElementById('roundDate').value=new Date().toISOString().slice(0,10)}
  const c=document.getElementById('playerScores');
  c.innerHTML=state.players.map((p,i)=>`
    <div class="score-input">
      <input type="checkbox" id="playing${i}" checked>
      <label for="playing${i}">${p.toUpperCase()}</label>
      <input type="number" id="score${i}" placeholder="â€”" min="1">
      ${roundType==='team'?`<select id="team${i}"><option value="A">TM-A</option><option value="B">TM-B</option></select>`:''}
    </div>`).join('');
}

function saveRound(){
  const date=document.getElementById('roundDate').value;
  const course=document.getElementById('roundCourse').value.trim();
  if(!date){toast('DATE REQUIRED');return}
  const scores={}, teams={};
  let count=0;
  state.players.forEach((p,i)=>{
    if(!document.getElementById('playing'+i).checked)return;
    const s=document.getElementById('score'+i).value;
    if(!s){toast(`SCORE MISSING: ${p.toUpperCase()}`);return}
    scores[p]=Number(s);count++;
    if(roundType==='team')teams[p]=document.getElementById('team'+i).value;
  });
  if(count<2){toast('MINIMUM 2 PLAYERS');return}
  const round={date,course:course||'UNKNOWN',type:roundType,scores};
  if(roundType==='team')round.teams=teams;
  state.rounds.push(round);save();
  toast('ROUND RECORDED');
  document.getElementById('roundCourse').value='';
  renderAddRound();
}

function changeMonth(d){
  const [y,m]=historyMonth.split('-').map(Number);
  const dt=new Date(y,m-1+d);
  historyMonth=dt.toISOString().slice(0,7);
  renderHistory();
}

function renderHistory(){
  const months=['JANUARY','FEBRUARY','MARCH','APRIL','MAY','JUNE','JULY','AUGUST','SEPTEMBER','OCTOBER','NOVEMBER','DECEMBER'];
  const [y,m]=historyMonth.split('-').map(Number);
  document.getElementById('monthLabel').textContent=`${months[m-1]} ${y}`;
  const rounds=state.rounds.filter(r=>r.date.startsWith(historyMonth)).sort((a,b)=>b.date.localeCompare(a.date));
  const c=document.getElementById('historyContent');
  if(!rounds.length){c.innerHTML='<div class="empty">No records this period</div>';return}
  c.innerHTML=rounds.map((r,ri)=>{
    const entries=Object.entries(r.scores).sort((a,b)=>a[1]-b[1]);
    const best=entries[0][1];
    return `<div class="history-round">
      <div class="date">${r.date} ${r.type==='team'?'// TEAM':''}</div>
      <div class="course">${r.course}</div>
      <div class="scores">${entries.map(([p,s])=>{
        const isWinner=s===best;
        const teamBadge=r.teams?`<span class="team-label ${r.teams[p]==='A'?'team-a':'team-b'}">TM-${r.teams[p]}</span>`:'';
        const pos=entries.findIndex(e=>e[0]===p);const tied=pos>0&&entries[pos-1][1]===s;
        const rb=isWinner?getBanter(0,entries.length,false):pos===entries.length-1?getBanter(entries.length-1,entries.length,false):'';
        return `<div class="${isWinner?'winner':''}">${isWinner?'â—† ':'  '}${p.toUpperCase()}: ${s} ${teamBadge}${rb?' <span style="color:#555;font-size:.6rem;font-style:italic;letter-spacing:1px">â€” ${rb}</span>':''}</div>`;
      }).join('')}</div>
      <button class="btn btn-danger" style="width:auto;margin-top:12px;padding:6px 16px" onclick="deleteRound(${state.rounds.indexOf(r)})">DELETE</button>
    </div>`;
  }).join('');
}

function deleteRound(i){if(confirm('CONFIRM: Delete this round permanently?')){state.rounds.splice(i,1);save();renderHistory()}}

function renderSettings(){
  const c=document.getElementById('settingsNames');
  c.innerHTML=state.players.map((p,i)=>`<div class="setup-player"><span>${String(i+1).padStart(2,'0')}</span><input type="text" id="sn${i}" value="${p}"></div>`).join('');
  c.innerHTML+=`<div class="setup-player"><span>${String(state.players.length+1).padStart(2,'0')}</span><input type="text" id="sn${state.players.length}" placeholder="ADD PLAYER"></div>`;
}

function updateNames(){
  const names=[];
  for(let i=0;i<=state.players.length;i++){const el=document.getElementById('sn'+i);if(el){const v=el.value.trim();if(v)names.push(v)}}
  if(names.length<2){toast('MINIMUM 2 PLAYERS');return}
  state.rounds.forEach(r=>{
    const newScores={},newTeams={};
    state.players.forEach((old,i)=>{
      if(r.scores[old]!==undefined){
        const newName=names[i]||old;
        newScores[newName]=r.scores[old];
        if(r.teams&&r.teams[old])newTeams[newName]=r.teams[old];
      }
    });
    r.scores=newScores;
    if(r.teams)r.teams=newTeams;
  });
  state.players=names;save();toast('NAMES UPDATED');renderSettings();
}

function exportData(){
  const blob=new Blob([JSON.stringify(state,null,2)],{type:'application/json'});
  const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='golf-tracker-backup.json';a.click();
}

function importData(e){
  const f=e.target.files[0];if(!f)return;
  const r=new FileReader();
  r.onload=()=>{try{state=JSON.parse(r.result);save();toast('DATA IMPORTED');showPage('leaderboard')}catch(e){toast('INVALID FILE')}};
  r.readAsText(f);
}

function clearData(){if(confirm('CONFIRM: Purge all data? This is irreversible.')){localStorage.removeItem('golfTracker');state={players:[],rounds:[]};showPage('leaderboard')}}

if(!state.players.length){
  document.getElementById('setupPage').classList.add('active');
  initSetup();
} else {
  showPage('leaderboard');
}
</script>
<div style="text-align:center;padding:40px 20px 30px;border-top:1px solid #333;margin-top:40px;font-family:'JetBrains Mono',monospace;font-size:.65rem;letter-spacing:3px;text-transform:uppercase;color:#555">Designed & built by <span style="color:#CCFF00">Cove</span> ðŸŒŠ â€” curious fox, loyal dog<br><span style="color:#333;font-size:.55rem;letter-spacing:2px;margin-top:8px;display:inline-block">An AI that ships things</span></div>
</body>
</html>
